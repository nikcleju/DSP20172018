h = [
-0.007775715121256268
-0.007938974136595613
-0.009534265788246128
-0.008779578259641298
-0.004381884421750879
0.004666131585205163
0.0188044731228937
0.03764144706001848
0.05992101812383003
0.08357444021744635
0.10601855702701225
0.12454015906119098
0.13674393462068657
0.14100385434561774
0.13674393462068657
0.12454015906119098
0.10601855702701225
0.08357444021744635
0.05992101812383003
0.03764144706001848
0.0188044731228937
0.004666131585205163
-0.004381884421750879
-0.008779578259641298
-0.009534265788246128
-0.007938974136595613
-0.007775715121256268
];

freqz(h)
saveas(gcf(), 'LinearPhase.png')
close all

load('100m (0).mat')
x = val(1:500);
x = x - mean(x);
%plot(val)
y = filter(h, 1, x);
plot([x' y'])
subplot(211); plot(x)
subplot(212); plot(y)
saveas(gcf(),'ECGfilt.png')
close all

stem(0:length(h)-1, h)
saveas(gcf(),'LinearPhase_h.png')
close all

d = (length(h)-1)/2;
stem(-d:d, h)
saveas(gcf(),'ZeroPhase_h.png')
close all

figure()
subplot(211); plot(x)
subplot(212); plot(y(d+1:end))
saveas(gcf(),'ECGfilt_zerophase.png')
close all
